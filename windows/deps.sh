#!/bin/sh

prefix=$HOME/mingw32
host=i486-mingw32
openssl_version="1.0.1e"
libcurl_version="7.30.0"
smartcardpp_version="0.3.0"
MAKEOPTS=-j3

rm -rf $prefix
mkdir $prefix
cd $prefix

wget -c https://www.openssl.org/source/openssl-${openssl_version}.tar.gz
tar xf openssl-${openssl_version}.tar.gz
cd openssl-$openssl_version
CC=$host-gcc perl Configure mingw no-shared no-docs --prefix=$prefix
make $MAKEOPTS || true
$host-ranlib libcrypto.a
$host-ranlib libssl.a
make $MAKEOPTS
make all install_sw
cd ..

wget -c http://curl.haxx.se/download/curl-${libcurl_version}.tar.bz2
tar xf curl-${libcurl_version}.tar.bz2
cd curl-$libcurl_version
./configure --with-ssl=$prefix --prefix=$prefix --host=$host --enable-static --disable-shared --disable-dict --disable-ftp --disable-imap --disable-ldap --disable-ldaps --disable-pop3 --disable-proxy --disable-rtsp --disable-smtp --disable-telnet --disable-tftp --without-gnutls --without-libidn --without-librtmp --without-libssh2 --without-nss --without-zlib
make $MAKEOPTS || (cd src; sed -i 's:-lssl -lcrypto -lgdi32 -lssl -lcrypto:-lssl -lcrypto -lgdi32:' Makefile; make $MAKEOPTS)
make install
cd ..

cat > mingw32.cmake << EOF
SET(CMAKE_SYSTEM_NAME Windows)
SET(COMPILER_PREFIX "$host")
find_program(CMAKE_RC_COMPILER NAMES \${COMPILER_PREFIX}-windres)
find_program(CMAKE_C_COMPILER NAMES \${COMPILER_PREFIX}-gcc)
find_program(CMAKE_CXX_COMPILER NAMES \${COMPILER_PREFIX}-g++)
SET(USER_ROOT_PATH $prefix)
SET(CMAKE_FIND_ROOT_PATH /usr/\${COMPILER_PREFIX} \${USER_ROOT_PATH})
set(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
set(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
set(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)
EOF

{ base64 -d | tar jxf -; } << EOF
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
KrFV//i7kinChIWAQozo
EOF

wget -c https://esteid.googlecode.com/files/smartcardpp-${smartcardpp_version}.tar.bz2
tar xf smartcardpp-${smartcardpp_version}.tar.bz2
cd smartcardpp-$smartcardpp_version
mv CMakeLists.txt CMakeLists.txt.orig
grep -v card-test CMakeLists.txt.orig > CMakeLists.txt
CXXFLAGS=-I$prefix/include LDFLAGS=-L$prefix/lib cmake -DCMAKE_TOOLCHAIN_FILE=$prefix/mingw32.cmake -DCMAKE_INSTALL_PREFIX=$prefix
sed -e 's/Windows.h/windows.h/g' -e 's/WinNT.h/winnt.h/g' -e 's/Psapi.h/psapi.h/g' -i CardBase.cpp PCSCManager.cpp
make $MAKEOPTS
make install
cd ..
